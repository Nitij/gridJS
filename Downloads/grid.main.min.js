(function (e, t, n) { "use strict"; function x(e) { return typeof e === "function" } function T() { var e = t.createElement("span"); e.innerHTML = "&nbsp;"; return e } function N() { var e = t.createElement("a"); e.setAttribute("href", "#"); e.style.textDecoration = "none"; e.style.paddingLeft = "2px"; e.style.paddingRight = "2px"; e.style.display = "inline-block"; return e } function C(e) { if (!F(e) && typeof e === "function") { e() } } function k(e) { var t = 0, n, r, i; for (; t < e.length; t++) { n = e[t]; i = this._grid.querySelector("#" + n.id); r = O.bind(i, [this, n.rowIndex, n.propToBind]); switch (i.type) { case a: case f: case l: case h: case p: case d: case v: case m: case g: case y: case b: case w: i.onchange = r; break; case c: i.onclick = r; break } } } function L(e, n, r, i) { var s, o = null, E = null, S = null, x = "", T = this._dataRowBackColors.length > 0, N = 0, C = 0, k = this._dataElement.querySelectorAll(u), L = this._dataSource, O = null, _ = {}; if (F(n)) { n = [] } s = document.createElement("tr"); s.setAttribute("id", this._gridID + "_dataRow_" + e); s.setAttribute("class", this._dataElement.className); if (T) { s.style.backgroundColor = this._dataRowBackColors[i] } if (r && this._hasMouseOverColor) { s.onmouseover = M.bind(null, [s, this._mouseOverColor]); s.onmouseout = M.bind(null, [s, s.style.backgroundColor]) } for (; N < k.length; N++) { o = document.createElement("td"); o.setAttribute("class", k[N].className); o.innerHTML = x = k[N].innerHTML; E = o.children; for (; C < E.length; C++) { S = E[C]; if (S.id !== "") { S.id = E[C].id += "_" + e; S.setAttribute("rowId", e) } if (this._bindInput) { switch (S.tagName.toLowerCase()) { case "input": if (S.getAttribute("model")) { n.push(A(S, e)); switch (S.type) { case a: case f: case l: case h: case p: case d: case v: case m: case g: case y: case b: case w: O = t.createAttribute("value"); O.value = S.getAttribute("model"); E[C].setAttributeNode(O); break; case c: if (D(S.getAttribute("model"), L, e, this._customFunctions, this._hasCustomBindings) === "true") { O = t.createAttribute("checked"); E[C].setAttributeNode(O) } break } } break } } } C = 0; x = D(o.innerHTML, L, e, this._customFunctions, this._hasCustomBindings); o.innerHTML = x; s.appendChild(o) } if (this._hasRowAddHandler) { s = this._rowAddHandler(s, L, e) } _["dataRow"] = s; _["inputBindings"] = n; return _ } function A(e, t) { var n = "", r = "", i = null, s = null, o = null, u = null, a = "", f = {}; n = e.getAttribute("model"); i = n.indexOf("{{"); s = n.indexOf("}}"); o = i + 2; u = s - 1; a = n.substr(o, u - o + 1); f["id"] = e.id; f["rowIndex"] = t; f["propToBind"] = a; return f } function O(e) { var t = null, n = e[0], r = e[1], i = e[2], s = null; switch (this.type) { case a: case f: case l: case h: case p: case d: case v: case m: case g: case y: case b: case w: t = this.value; break; case c: t = this.checked; break } n._dataSource[r][i] = t; n._dataChanges["row" + r] = n._dataSource[r]; if (n._updateRowOnDataChange) { n.reDrawRow.call(n, r) } } function M(e) { var t = e[0], n = e[1]; t.style.backgroundColor = n } function _(e) { if (!F(this._beforeGridPageChange)) this._beforeGridPageChange(e[0]); if (this._allowPageChange) { this._currentPageNumber = e[0]; C(this._onGridPageChange); this.reDraw() } return false } function D(e, t, n, r, i) { var s = 0, o = e.length, u = "", a = 0, f = 0, l = 0, c = 0, h = "", p = "", d = e, v = t[n], m = null; for (; s < o; s++) { if (s < o) { u = e.substr(s, 2); if (u === "{{") { a = s; l = s + 2 } else if (u === "}}") { f = s + 1; c = s - 1; h = e.substr(a, f - a + 1); p = e.substr(l, c - l + 1); if (!P(p)) { m = B(v, p); d = d.replace(h, F(m) ? "" : m) } else { if (i) { d = d.replace(h, H(p, t, n, r)) } else { d = d.replace(h, "") } } d = d.replace("model-src", "src") } } } return d } function P(e) { var t = e.length; if (t) { if (e.substr(t - 2, 2) === "()") { return true } else { return false } } } function H(e, t, n, r) { var i = e.replace("()", ""), i = r[i]; if (!F(i)) { return i(t, n) } } function B(e, t) { var n = 0, r = t.length, i = "", s = 0, o = 0, u = "", a = false; for (; n < r; n++) { if (n < r) { i = t.substr(n, 1); if (a) { s = n; a = false } if ((i === "[" || i === "." || i === "]") && n < r - 1) { o = n; e = j(t, e, s, o); a = true } if (n === r - 1) { if (i === "]") { o = n } else { o = n + 1 } e = j(t, e, s, o); a = true } } } return e } function j(e, t, n, r) { var i = e.substr(n, r - n); if (i.length > 0) { t = t[i] } return t } function F(e) { return e === null || e === n } var r = null; var i = "headerRow", s = "dataRow", o = "footerRow", u = "column", a = "text", f = "number", l = "password", c = "checkbox", h = "search", p = "tel", d = "url", v = "email", m = "time", g = "datetime", y = "date", b = "month", w = "week"; var E = 1, S = 5; if (t.registerElement) { t.registerElement("gridjs-grid") } r = function (e) { var n = null, r = null, i = e; this._sourceGrid = null; this._grid = null; this._gridID = null; this._dataSource = null; this._dataItemCount = 0; this._dataRowBackColors = []; this._cellPadding = S; this._hasRowAddHandler = false; this._rowAddHandler = null; this._hasMouseOverColor = false; this._mouseOverColor = ""; this._hasPagination = false; this._pageRowCount = 0; this._currentPageNumber = E; this._headerElement = null; this._dataElement = null; this._footerElement = null; this._pageButtonNormalCss = ""; this._pageButtonActiveCss = ""; this._dataChanges = {}; this._bindInput = true; this._updateRowOnDataChange = true; this._customFunctions = {}; this._hasCustomBindings = false; this._allowPageChange = true; this._onGridLoaded = null; this._onGridPageChange = null; this._beforeGridPageChange = null; this._onRowRedrawComplete = null; if (i["gridId"]) { this._sourceGrid = t.createElement("gridjs"); this._gridID = i["gridId"]; this._grid = t.querySelector("#" + i["gridId"]); this._sourceGrid.innerHTML = this._grid.innerHTML } if (i["dataSource"]) { this._dataSource = i["dataSource"]; this._dataItemCount = i["dataSource"].length } if (!F(i["updateDataRowOnInputChange"])) this._updateRowOnDataChange = i["updateDataRowOnInputChange"]; n = i["beforeGridPageChange"]; if (n && x(n)) this._beforeGridPageChange = n; n = i["onRowRedrawComplete"]; if (n && x(n)) this._onRowRedrawComplete = n; n = i["onGridPageChange"]; if (n && x(n)) this._onGridPageChange = n; n = i["onGridLoaded"]; if (n && x(n)) this._onGridLoaded = n; this._allowPageChange = i["allowPageChange"] || true; this._bindInput = i["disableInputBindings"] || true; r = i["pageButtonCss"]; if (r) { this._pageButtonNormalCss = r["normalCss"]; this._pageButtonActiveCss = r["activeCss"] } if (i["pagination"]) { this._hasPagination = true; this._pageRowCount = i["pagination"] } r = i["dataRowColors"]; if (r && r.length && typeof r !== "[Object object]") this._dataRowBackColors = r; r = i["cellPadding"]; if (r) this._cellPadding = r; n = i["onRowAddition"]; if (n && x(n)) { this._hasRowAddHandler = true; this._rowAddHandler = n } r = i["mouseOverColor"]; if (r) { this._hasMouseOverColor = true; this._mouseOverColor = r } return this }; r.prototype = { updateDataRowOnInputChange: function (e) { this._updateRowOnDataChange = e; return this }, beforeGridPageChange: function (e) { if (x(e)) this._beforeGridPageChange = e; return this }, onRowRedrawComplete: function (e) { if (x(e)) this._onRowRedrawComplete = e; return this }, onGridPageChange: function (e) { if (x(e)) this._onGridPageChange = e; return this }, onGridLoaded: function (e) { if (x(e)) this._onGridLoaded = e; return this }, allowPageChange: function (e) { this._allowPageChange = e; return this }, addCustomFunction: function (e, t) { this._customFunctions[e] = t; this._hasCustomBindings = true; return this }, disableInputBindings: function (e) { this._bindInput = e; return this }, setPageButtonCss: function (e, t) { this._pageButtonNormalCss = e; this._pageButtonActiveCss = t; return this }, init: function () { this._headerElement = this._sourceGrid.querySelector(i); this._dataElement = this._sourceGrid.querySelector(s); this._footerElement = this._sourceGrid.querySelector(o); return this }, draw: function () { this.init().reDraw(); return this }, setPagination: function (e) { this._hasPagination = true; this._pageRowCount = e; return this }, getGrid: function (e) { this._gridID = e; this._sourceGrid = t.createElement("gridjs"); this._grid = t.querySelector("#" + e); this._sourceGrid.innerHTML = this._grid.innerHTML; return this }, dataSource: function (e) { this._dataSource = e; this._dataItemCount = e.length; return this }, reDraw: function () { var e = this._dataSource, n = this._headerElement, r = n.querySelectorAll(u), i = this._dataElement, s = i.querySelectorAll(u), o = this._footerElement, a = o.querySelectorAll(u), f = 0, l = 0, c = 0, h = 0, p = null, d = null, v = null, m = "", g = null, y = null, b = null, w = null, E = null, S = null, x = null, A = null, O = this._dataRowBackColors.length > 0, M = null, D = null, P = null, H = null, B = [], j = null, F = null; w = t.createElement("table"); w.setAttribute("cellspacing", 0); w.setAttribute("cellpadding", this._cellPadding); w.setAttribute("class", this._grid.className); g = t.createElement("tr"); g.setAttribute("class", n.className); for (; f < r.length; f++) { E = document.createElement("td"); E.setAttribute("class", r[f].className); E.innerHTML = r[f].innerHTML; g.appendChild(E) } w.appendChild(g); p = e.length; if (this._hasPagination) { d = 0 + this._currentPageNumber * this._pageRowCount - this._pageRowCount; v = this._currentPageNumber * this._pageRowCount; if (v > p) v = p } else { d = 0; v = p } for (; d < v; d++) { if (h === this._dataRowBackColors.length) { h = 0 } j = L.call(this, d, B, true, h); h++; w.appendChild(j.dataRow); B = j.inputBindings; l = 0 } f = 0; b = t.createElement("tr"); b.setAttribute("class", o.className); for (; f < a.length; f++) { x = document.createElement("td"); x.setAttribute("class", a[f].className); x.innerHTML = a[f].innerHTML; b.appendChild(x) } w.appendChild(b); if (this._hasPagination) { M = t.createElement("div"); M.setAttribute("class", this._grid.className); M.style.textAlign = "center"; M.style.textDecoration = "none"; M.style.paddingTop = "4px"; if (this._currentPageNumber > 1) { D = N(); D.setAttribute("class", this._pageButtonNormalCss); D.innerHTML = "<"; P = _.bind(this, [this._currentPageNumber - 1]); D.onclick = P; M.appendChild(D); M.appendChild(T()) } f = 1; l = parseInt(p / this._pageRowCount); if (p % this._pageRowCount > 0) l++; for (; f <= l; f++) { D = N(); if (f === this._currentPageNumber) { D.setAttribute("class", this._pageButtonActiveCss); D.style.fontWeight = "bold" } else { D.setAttribute("class", this._pageButtonNormalCss) } P = _.bind(this, [f]); D.onclick = P; D.innerHTML = f; M.appendChild(D); M.appendChild(T()) } if (this._currentPageNumber < l) { D = N(); D.setAttribute("class", this._pageButtonNormalCss); D.innerHTML = ">"; P = _.bind(this, [this._currentPageNumber + 1]); D.onclick = P; M.appendChild(D) } } this._grid.innerHTML = ""; this._grid.appendChild(w); if (this._hasPagination) { this._grid.appendChild(M) } if (this._bindInput) { k.call(this, B) } C(this._onGridLoaded); return this }, reDrawRow: function () { var e = arguments[0], n = t.querySelector("#" + this._gridID + "_dataRow_" + e), r = null; n.innerHTML = ""; r = L.call(this, e, null, false, null); n.innerHTML = r.dataRow.innerHTML; if (!F(this._onRowRedrawComplete)) { this._onRowRedrawComplete(this._dataSource, e) } k.call(this, r.inputBindings); return this }, setDataRowColors: function (e) { if (e.length && typeof e !== "[Object object]") this._dataRowBackColors = e; return this }, setCellPadding: function (e) { this._cellPadding = e; return this }, onRowAddition: function (e) { this._hasRowAddHandler = true; this._rowAddHandler = e; return this }, setMouseOverColor: function (e) { this._hasMouseOverColor = true; this._mouseOverColor = e; return this }, getDataUpdates: function () { var e = []; var t = this._dataChanges; for (var n in t) { e.push(n) } return e }, drawGridByPage: function (e) { if (!F(this._beforeGridPageChange)) this._beforeGridPageChange(e[0]); if (this._allowPageChange) { this._currentPageNumber = e[0]; C(this._onGridPageChange); this.reDraw() } return false } }; e["GridJS"] = r })(window, document)